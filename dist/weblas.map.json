{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","index.js","lib/webgl.js","lib/test.js","lib/gemmfloatcalculator.js","node_modules/async/lib/async.js","node_modules/floader/lib/xhr-loader.js","node_modules/browserify/node_modules/process/browser.js"],"names":["WebGL","require","GEMMFloatCalculator","test","module","exports","options","glOptions","ext","canvas","this","document","createElement","premultipliedAlpha","preserveDrawingBuffer","context","getContext","Error","getExtension","e","hasFloat","console","log","highp","getShaderPrecisionFormat","FRAGMENT_SHADER","HIGH_FLOAT","hasHighPrecision","precision","vertexShader","createShader","VERTEX_SHADER","shaderSource","PASS_THROUGH_VERTEX_SHADER","compileShader","prototype","createProgram","fragmentShaderSource","fragmentShader","gl","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","program","attachShader","linkProgram","createDestinationTexture","h","w","destTexture","createTexture","activeTexture","TEXTURE2","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","fromArray","array","type","tranpose","data","c","shape","length","Float32Array","ii","jj","async","loader","allclose","a","b","RTOL","ATOL","result","index","i","Math","abs","randomArray","N","M","row","j","random","sqrt","push","matrixFiles","load","testDirectory","callback","testFiles","map","item","err","results","JSON","parse","webgl","packData","d1","h1","w1","d2","h2","w2","BYTES_PER_TEXEL","r1","c1","r2","c2","r","max","texelcount","texels","dst","src1","src2","col","texel","TEXTURE_UNIFORM_NAME","bindInputTexture","height","width","viewport","texture","TEXTURE0","RGB","FLOAT","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","sampler","getUniformLocation","uniform1i","bindDestinationTexture","dstTex","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","calculate","K","alpha","A","B","beta","C","frameBuffer","rawbuffer","useProgram","bindUniforms","bindVertices","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","drawElements","TRIANGLES","UNSIGNED_SHORT","ArrayBuffer","BYTES_PER_ELEMENT","prod","Uint8Array","readPixels","delCol","delRow","uniform1f","renderer","aPos","getAttribLocation","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","vertices","bufferData","STATIC_DRAW","vertexAttribPointer","enableVertexAttribArray","aTex","texCoords","textureCoords","indices","ELEMENT_ARRAY_BUFFER","vertexIndices","Uint16Array","noop","identity","v","toBool","notId","only_once","fn","apply","arguments","_once","_isArrayLike","arr","_isArray","_arrayEach","iterator","_map","Array","_range","count","_reduce","memo","x","_forEachOf","object","_keys","key","_indexOf","_keyIterator","coll","len","keys","_restParam","func","startIndex","rest","call","_withoutIndex","value","_eachOfLimit","limit","obj","nextKey","done","running","errored","replenish","doParallel","eachOf","doParallelLimit","doSeries","eachOfSeries","_asyncMap","eachfn","_filter","sort","_reject","cb","_createTester","check","getResult","iteratee","_","_findGetResult","_parallel","tasks","task","args","_concat","y","concat","_queue","worker","concurrency","payload","_insert","q","pos","started","idle","setImmediate","drain","unshift","saturated","process","_next","workers","removed","workersList","splice","empty","paused","kill","pause","resume","resumeCount","min","_console_fn","name","error","_times","mapper","_applyEach","fns","go","that","pop","ensureAsync","innerArgs","sync","previous_async","root","self","global","noConflict","_toString","Object","toString","isArray","_isObject","k","hasOwnProperty","_setImmediate","_delay","setTimeout","nextTick","forEach","each","forEachSeries","eachSeries","forEachLimit","eachLimit","forEachOf","completed","iter","forEachOfSeries","iterate","forEachOfLimit","eachOfLimit","mapSeries","mapLimit","inject","foldl","reduce","foldr","reduceRight","reversed","reverse","transform","select","filter","selectLimit","filterLimit","selectSeries","filterSeries","reject","rejectLimit","rejectSeries","any","some","someLimit","all","every","everyLimit","detect","detectSeries","detectLimit","sortBy","comparator","left","right","criteria","auto","addListener","listeners","removeListener","idx","taskComplete","remainingTasks","slice","runningTasks","ready","requires","listener","taskCallback","dep","safeResults","val","rkey","retry","times","parseTimes","acc","t","parseInt","DEFAULT_TIMES","interval","DEFAULT_INTERVAL","wrappedTask","wrappedCallback","wrappedResults","retryAttempt","finalAttempt","seriesCallback","retryInterval","opts","attempts","series","waterfall","wrapIterator","next","parallel","parallelLimit","makeCallback","callArgs","concatSeries","whilst","doWhilst","calls","until","doUntil","during","truth","doDuring","queue","items","priorityQueue","_compareTasks","priority","_binarySearch","sequence","compare","beg","end","mid","cargo","dir","memoize","hasher","queues","memoized","l","unmemoized","unmemoize","timesSeries","timesLimit","seq","newargs","nextargs","compose","applyEach","applyEachSeries","forever","constant","values","wrapSync","asyncify","then","message","define","amd","url","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","errno","open","send","cleanUpNextTick","draining","currentQueue","queueIndex","drainQueue","timeout","run","clearTimeout","Item","fun","title","browser","env","argv","version","versions","on","once","off","removeAllListeners","emit","binding","cwd","chdir","umask"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var WebGL = require(\"./lib/webgl\"),\n    GEMMFloatCalculator = require(\"./lib/gemmfloatcalculator\"),\n    test = require(\"./lib/test\");\n\n\n\nmodule.exports = {\n    \"WebGL\" : WebGL,\n    \"GEMMFloatCalculator\" : GEMMFloatCalculator,\n    \"test\" : test\n};\n","/*\nCopyright (c) 2015 Waylon Flinn\n\nwebgl.js\n\nmultiply matrices up to 4096 x 4096 on GPUs that support OES_texture_float\nextension. input is encoded into the red and green channels of an input texture and\ncalculations are done using a custom fragment shader.\n\n*/\n\n\n/*\n\tA WebGL context associated with a specific canvas element.\n\n\t* creates a canvas\n\t* sets up webgl context\n\t* translates numbers into textures\n\t* compiles shader programs for executing math (when supplied with an\n\t\toperation specific fragment shader)\n */\nfunction WebGL(options) {\n\n\tvar glOptions,\n\t\text;\n\n\toptions = options || {};\n\n\t// canvas\n\tif(typeof options.canvas === 'undefined')\n\t\tthis.canvas = document.createElement('canvas');\n\telse\n\t\tthis.canvas = options.canvas;\n\n\t// context\n\tglOptions = { premultipliedAlpha: false, preserveDrawingBuffer: false };\n\tthis.context = this.canvas.getContext(\"experimental-webgl\", glOptions);\n\n\tif (typeof this.context === 'undefined')\n\t\tthrow new Error(\"No support for Webgl.\");\n\n\t// float texture extension\n\ttry {\n\t\text = this.context.getExtension('OES_texture_float');\n\t} catch(e) {\n\n\t}\n\tif ( !ext ) {\n\t\tconsole.log(\"No support for OES_texture_float extension.\");\n\t\tthis.hasFloat = false;\n\t} else {\n\t\tthis.hasFloat = true;\n\t}\n\n\tvar highp = this.context.getShaderPrecisionFormat(this.context.FRAGMENT_SHADER, this.context.HIGH_FLOAT);\n\tthis.hasHighPrecision = highp.precision != 0;\n\tif(this.hasHighPrecision) this.highp = highp;\n\n\t// create pass through vertex shader\n\tthis.vertexShader = this.context.createShader(this.context.VERTEX_SHADER);\n\tthis.context.shaderSource(this.vertexShader, WebGL.PASS_THROUGH_VERTEX_SHADER);\n\tthis.context.compileShader(this.vertexShader);\n\n};\n\nmodule.exports = WebGL;\n\nWebGL.PASS_THROUGH_VERTEX_SHADER = \"\\\n// vertex shader for a single quad                                           \\n\\\n// work is performed in the operation specific texture shader                \\n\\\n#ifdef GL_ES                                                                 \\n\\\nprecision highp float;                                                       \\n\\\n#endif                                                                       \\n\\\nattribute vec3 aPos;                                                         \\n\\\nattribute vec2 aTex;                                                         \\n\\\nvarying vec2   outTex;                                                         \\n\\\nvoid main(void)                                                              \\n\\\n{                                                                            \\n\\\n\t// just pass the position and texture coords                             \\n\\\n\tgl_Position = vec4(aPos, 1.0);                                           \\n\\\n\toutTex = aTex;                                                             \\n\\\n}                                                                            \\n\\\n\";\n\n/*  Create a shader program based on a pass through vertex shader and\n\tthe supplied operation specific fragment shader.\n\n\tfragmentShaderSource - string containing the fragment shader source code.\n\tshader will recieve `vec2 outTex` with texture coordinates from the pass\n\tthrough vertex shader.\n */\nWebGL.prototype.createProgram = function(fragmentShaderSource){\n\tvar gl = this.context,\n\t\tfragmentShader;\n\n\t// compile the provided fragment/texture shader\n\tfragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n\tgl.shaderSource(fragmentShader, fragmentShaderSource);\n\tgl.compileShader(fragmentShader);\n\n\t// did it compile correctly?\n\tif (gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS) == 0)\n\t\tthrow new Error(gl.getShaderInfoLog(fragmentShader));\n\n\t// link the program specific fragment shader and the generic pass through\n\t// shader into a program\n\tvar program = gl.createProgram();\n\tgl.attachShader(program, this.vertexShader);\n\tgl.attachShader(program, fragmentShader);\n\tgl.linkProgram(program);\n\n\treturn program;\n};\n\n/* Create and bind a texture to store the result.\n   Requires canvas height and width be set to size of output matrix.\n */\nWebGL.prototype.createDestinationTexture = function(h, w) {\n\tvar gl = this.context;\n\n\t// create and bind texture to render to\n\tvar destTexture = gl.createTexture();\n\tgl.activeTexture(gl.TEXTURE2);\n\tgl.bindTexture(gl.TEXTURE_2D, destTexture);\n\tgl.texImage2D(gl.TEXTURE_2D,/*level*/0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n\treturn destTexture;\n};\n\n/* create a typed array from a 2D javascript array */\nWebGL.fromArray = function(array, type, tranpose) {\n\tvar shape = [],\n\t\t\tdata,\n\t\t\tc;   // number of columns\n\n\tif(!tranpose){\n\t\tshape[0] = array.length;\n\t\tshape[1] = array[0].length;\n\t} else {\n\t\tshape[1] = array.length;\n\t\tshape[0] = array[0].length;\n\t}\n\tc = shape[1];\n\n\ttype = type || Float32Array;\n\n\tdata = new type(shape[0]*shape[1]);\n\n\tfor (var ii = 0; ii < shape[0]; ++ii)\n\t\tfor (var jj = 0; jj < shape[1]; ++jj)\n\t\tif(!tranpose)\n\t\t\tdata[ii*c + jj] = array[ii][jj];\n\t\telse\n\t\t\tdata[ii*c + jj] = array[jj][ii];\n\n\treturn data;\n};\n","var async = require('async'),\n\tloader = require('floader'); // browserify aware file loader (xhr in browser)\n\n/* Collection of helper methods for testing numerical computation\n */\ntest = {};\n\n/* Check all entries in two TypedArrays of identical length for approximate\n\tequality.\n\tIf the following equation is element-wise true, returns true\n\n\tabsolute(a - b) <= (atol + rtol * absolute(b))\n\n\tfrom numpy.allclose\n */\ntest.allclose = function(a, b, RTOL, ATOL){\n\tRTOL= RTOL || 1e-05;  // for 32 bit precision: 1e-06\n\tATOL= ATOL || 1e-12;\n\n\tif(a.length != b.length){\n\t\tconsole.log(\"lengths not equal: \" + a.length + \", \" + b.length);\n\t\treturn {\"result\" : false, \"index\": null};\n\t}\n\n\tvar result;\n\tfor(var i = 0; i < a.length; i++){\n\n\t\tresult = Math.abs(a[i] - b[i]) <= ATOL + RTOL * Math.abs(b[i]);\n\n\t\tif(!result) {\n\t\t\treturn {\"result\": false, \"index\": i};\n\t\t}\n\t}\n\n\treturn {\"result\": true, \"index\": i};\n};\n\ntest.randomArray = function(N, M){\n\n\tvar data = [];\n\n\tfor(var i = 0; i < N; i++){\n\t\tvar row = [];\n\t\tfor(var j = 0; j < M; j++){\n\t\t\trow[j] = Math.random() / Math.sqrt(N);\n\t\t}\n\t\tdata.push(row);\n\t}\n\n\treturn data;\n};\n\nvar matrixFiles = ['a.json', 'b.json', 'c.json'];\n\n/* Load test matrices from JSON data, works in a browser (with XHR)\n\tassumes three files 'a.json', 'b.json' and 'c.json' in nested Array format.\n\n callback = function(err, a, b, c)\n */\ntest.load = function(testDirectory, callback){\n\n\tvar a, b, c; // javascript arrays\n\n\t// array of paths to matrix data files for current test\n\tvar testFiles = matrixFiles.map(function(item){ return testDirectory + item;});\n\n\t//console.log(testFiles);\n\tasync.map(testFiles, loader.load,\n\t\tfunction(err, results){\n\n\t\t\tif(err) return callback(err);\n\n\t\t\t// results contains three strings.\n\t\t\t// each string contains the contents of a file\n\t\t\t// files contain JSON describing a matrix (2D array)\n\t\t\ta = JSON.parse(results[0]);\n\t\t\tb = JSON.parse(results[1]);\n\t\t\tc = JSON.parse(results[2]);\n\n\t\t\tcallback(err, a, b, c);\n\t\t}\n\t);\n};\n\nmodule.exports = test;\n","\n\n/* A calculator object for the Float texture based GEMM\n\n\tgl - WebGL object\n\n\t* uploads and downloads data\n\t* executes calculation\n */\nfunction GEMMFloatCalculator(webgl){\n\tthis.webgl = webgl;\n\n\n\t// create the webgl shader program for this calculation\n\t// based on the specific fragment shader for this calculation\n\t// and the generic pass through shader\n\tthis.program = this.webgl.createProgram(GEMMFloatCalculator.FRAGMENT_SHADER);\n\n}\n\nmodule.exports = GEMMFloatCalculator;\n\nGEMMFloatCalculator.FRAGMENT_SHADER = \"                                  \\n\\\n// fragment shader that calculates the sum of the passed row and         \\n\\\n// column (texture coord).                                               \\n\\\n// we loop over the row and column and sum the product.                  \\n\\\n// product is then rendered to 32-bit IEEE754 floating point in the      \\n\\\n// output RGBA canvas.                                                   \\n\\\n// readPixel is used to read the bytes.                                  \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n#ifdef GL_ES                                                             \\n\\\nprecision highp float;                                                   \\n\\\n#endif                                                                   \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\nvarying vec2\t  outTex;     // row, column to calculate                \\n\\\nuniform sampler2D usampler;\t  // left in .r, right in .g                 \\n\\\nuniform int\t\t  K;          // interior (matching) dimension (r1/c2)   \\n\\\nuniform float\t  delCol;     // space between columns on source texture \\n\\\nuniform float\t  delRow;     // space between rows on source texture    \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n// sum row i x col j                                                     \\n\\\nfloat sumrowcol(float i, float j) {                                      \\n\\\n\tfloat sum = 0.;                // sum                                \\n\\\n\tfloat k_c = 0.5 * delCol;      // column position on source texture  \\n\\\n\tfloat k_r = 0.5 * delRow;      // row position on source texture     \\n\\\n\tfor (int k=0 ; k<4096 ; ++k) {                                       \\n\\\n\t\tif(k >= K) break;         // stop when we finish the row/column  \\n\\\n\t\tfloat a_ik = texture2D(usampler,vec2( k_c,   i)).r;              \\n\\\n\t\tfloat b_kj = texture2D(usampler,vec2(   j, k_r)).g;              \\n\\\n\t\tsum += (a_ik*b_kj);                                              \\n\\\n\t\tk_c += delCol;      // (k + 0.5)*delCol                          \\n\\\n\t\tk_r += delRow;\t    // (k + 0.5)*delRow                          \\n\\\n\t}                                                                    \\n\\\n\treturn sum;                                                          \\n\\\n}                                                                        \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n// Render float to bytes according to IEEE 754 Floating Point            \\n\\\nvec4 encodeFloat(float val) {                                            \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\t// TODO: correctly handle denormal numbers                           \\n\\\n\t// http://www.2ality.com/2012/04/number-encoding.html                \\n\\\n\tfloat a = abs(val);                           // encode absolute value + sign \\n\\\n\tfloat exp = floor(log2(a));                 // number of powers of 2 \\n\\\n\tfloat mant = pow(2.,log2(a)-exp) * pow(2.,23.);  // multiply to fill 24 bits (implied leading 1) \\n\\\n\tfloat mant1 = floor(mant / 256. / 256.);    // first 8 bits of mantissa \\n\\\n\tfloat mant2 = mod(floor(mant / 256.),256.); // second 8 bits         \\n\\\n\tfloat mant3 = mod(mant,256.);               // third 8 bits          \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\thighp float sign = 128.-128.*(a/val);\t\t\t// sign bit is 256 or 0  \\n\\\n\thighp float e = (sign+exp+127.)/510.;\t\t// exponent and sign     \\n\\\n\thighp float m1 = (mant1-(128.*(1.-mod(exp+127.,2.))))/255.; // handle leading bit \\n\\\n\thighp float m2 = (mant2)/255.;\t\t\t\t// middle part           \\n\\\n\thighp float m3 = (mant3+.5)/255.;\t\t\t// scale to 0 - 255      \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\treturn vec4(m3,m2,m1,e);                                             \\n\\\n}                                                                        \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\nvoid main(void) {                                                        \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\t // get the implied row and column from .y and .x                    \\n\\\n\t // of passed (output) texel                                         \\n\\\n \tfloat row = outTex.y;                                                \\n\\\n\tfloat col = outTex.x;                                                \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\t// sum row x col for the passed pixel                                \\n\\\n\tfloat sum = sumrowcol(row,col);                                      \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n\tif (sum == 0.) {                                                     \\n\\\n\t\tgl_FragColor = vec4(0.,0.,0.,0.);                                \\n\\\n\t\treturn;                                                          \\n\\\n\t}                                                                    \\n\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \\n\\\n \t// output an IEEE754 32-bit floating point number \t\t\t\t  \t \\n\\\n\tgl_FragColor = encodeFloat(sum);\t\t\t\t\t\t\t\t\t \\n\\\n}                                                                        \\n\\\n\";\n\n/* Pack the given matrix data into texel layout for use by texture shader.\n   This layout places each matrix in a different plane of the texture,\n   one in 'r' the second in 'g'\n */\nGEMMFloatCalculator.packData = function(d1, h1, w1, d2, h2, w2) {\n\n\t// dimensions\n\tvar BYTES_PER_TEXEL = 3; // RGB: one byte per channel, three bytes per texel\n\tvar r1 = h1, c1 = w1, r2 = h2, c2 = w2;\n\tvar r = Math.max(r1,r2);\n\tvar c = Math.max(c1,c2);\n\tvar texelcount = r*c;\n\t// get texel data (rgb) as a Float32Array\n\tvar texels = new Float32Array(texelcount*BYTES_PER_TEXEL);\n\n\tvar dst = 0, src1=0, src2=0;\n\t// special case if same dimensions\n\tif (r1===r2 && c1===c2) {\n\t\t// copy m1 to .r and m2 to .g\n\t\tdo {\n\t\t\ttexels[dst++] = d1[src1++]; // red\n\t\t\ttexels[dst++] = d2[src2++]; // green\n\t\t\tdst++;\t\t\t\t\t\t// blue\n\t\t} while(--texelcount);\n\t} else {\n\n\t\tvar row=0, col=0, texel = 0;\n\t\tdo {\n\t\t\ttexel = dst / BYTES_PER_TEXEL | 0;\n\t\t\tcol = texel % c;\n\t\t\trow = texel / c | 0;\n\t\t\tif(col < c1 && row < r1)\n\t\t\t\ttexels[dst] = d1[src1++];\n\n\t\t\tdst++;\t\t\t\t\t\t// red -> green\n\n\t\t\tif(col < c2 && row < r2)\n\t\t\t\ttexels[dst] = d2[src2++];\n\n\t\t\tdst += 2;\t\t\t\t\t\t// green -> red (skip blue)\n\n\t\t} while(--texelcount);\n\n\t}\n\treturn texels;\n};\n\nGEMMFloatCalculator.TEXTURE_UNIFORM_NAME = \"usampler\";\n\n/* Create a texture from the given texel data and bind it to our shader program.\n  must set up shader first\n*/\nGEMMFloatCalculator.prototype.bindInputTexture = function(h, w, texels){\n\tvar gl = this.webgl.context,\n\t\tprogram = this.program;\n\n\n\t// set canvas and viewport size\n\tthis.webgl.canvas.height = h;\n\tthis.webgl.canvas.width = w;\n\tgl.viewport(0, 0, w, h);\n\n\t// create the texture from our floats\n\tvar texture = gl.createTexture();\n\tgl.activeTexture(gl.TEXTURE0);\n\tgl.bindTexture(\t  gl.TEXTURE_2D, texture);\n\tgl.texImage2D(\t  gl.TEXTURE_2D, /*level*/0, gl.RGB, w, h, 0,\n\t\t\t\t\t  gl.RGB, gl.FLOAT, texels);\n\n\t// clamp to edge to support non-power of two textures\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t// don't interpolate when getting data from texture\n\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n\tvar sampler = gl.getUniformLocation(program, GEMMFloatCalculator.TEXTURE_UNIFORM_NAME);\n\tgl.uniform1i(sampler, 0); // (textureUnit - gl.TEXTURE0)\n\n\treturn texture;\n};\n\nGEMMFloatCalculator.prototype.bindDestinationTexture = function(h1, w2, dstTex) {\n\tvar gl = this.webgl.context;\n\n\t// create and bind renderbuffer\n\tthis.renderbuffer = this.renderbuffer || gl.createRenderbuffer();\n\n\tgl.bindRenderbuffer(gl.RENDERBUFFER, null);\n\tgl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbuffer);\n\n\tgl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16, w2, h1);\n\n\t// create and bind framebuffer\n\tthis.framebuffer = this.framebuffer || gl.createFramebuffer();\n\n\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n\n\tgl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,dstTex,/*level*/0);\n\tgl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this.renderbuffer);\n\n\treturn this.framebuffer;\n};\n\n/* Calculate the GEMM, with the given data.\n\n  Steps are:\n\n  1. Activate our shader program\n  2. Create a texture to hold the input data\n  3. Set shader program parameters (based on matrix sizes)\n  4. Create a texture to hold the output\n  5. Activate calculation with `drawElements`\n  6. Read result with `readPixels` and return it\n\n TODO: signature should look like this:\n ( TRANSA, TRANSB, M, N, K, ALPHA, A, LDA, B, LDB, BETA, C, LDC )\n http://www.math.utah.edu/software/lapack/lapack-blas/dgemm.html\n */\nGEMMFloatCalculator.prototype.calculate = function(M, N, K, alpha, A, B, beta, C){\n\n\tvar gl = this.webgl.context,\n\t\tdestTexture,\n\t\tframeBuffer,\n\t\trawbuffer;\n\n\tvar h1 = M,\n\t\tw1 = K,\n\t\th2 = K,\n\t\tw2 = N;\n\n\tvar h = Math.max(h1, h2),\n\t\tw = Math.max(w1, w2);\n\n\t//console.log(h1 + \"x\" + w1 + \" times \" + h2 + \"x\" + w2);\n\t// set calculator program to current shader program\n\tgl.useProgram(this.program);\n\n\n\t// pack the data into a single RGB texel array\n\tvar texels = GEMMFloatCalculator.packData(A, h1, w1, B, h2, w2);\n\n\t// create and bind our input texture using matrix data\n\tthis.bindInputTexture(h, w, texels);\n\n\n\t// set the data specific variables in our shader program\n\tthis.bindUniforms(h, w, K);\n\tthis.bindVertices();\n\n\t// create our destination texture\n\tdestTexture = this.webgl.createDestinationTexture(M, N);\n\tframeBuffer = this.bindDestinationTexture(M, N, destTexture);\n\n\n\tif( gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE)\n\t\tthrow new Error(\"Bound framebuffer is not complete.\");\n\n\t// initiate calculation\n\tgl.drawElements(gl.TRIANGLES, /*num items*/6, gl.UNSIGNED_SHORT, 0);\n\n\t// create destination buffer\n\trawbuffer = new ArrayBuffer(M*N*Float32Array.BYTES_PER_ELEMENT);\n\n\t// read the result into our buffer, as bytes\n\tprod = new Uint8Array(rawbuffer);\n\tgl.readPixels(0, 0, N, M, gl.RGBA, gl.UNSIGNED_BYTE, prod);\n\n\t// create and return a view over result bytes as a float array\n\treturn new Float32Array(rawbuffer); // M x N\n};\n\n\t// set up vars for the shaders\nGEMMFloatCalculator.prototype.bindUniforms = function(h, w, K) {\n\tvar gl = this.webgl.context;\n\n\t// get var locations\n\tvar length\t= gl.getUniformLocation(this.program, \"K\");\n\tvar delCol\t= gl.getUniformLocation(this.program, \"delCol\");\n\tvar delRow\t= gl.getUniformLocation(this.program, \"delRow\");\n\n\t// bind length of shared dimension\n\tgl.uniform1i(length, K);\n\n\t// bind step size for input texture\n\t// 3x10 x 10x2 -> 3x2 output, but requires 10x10 *input* texture\n\tgl.uniform1f(delCol, 1./w);\n\tgl.uniform1f(delRow, 1./h);\n};\n\n/* setup required to draw a square to our vertex shader and have\n   fragment shader called for each pixel\n */\nGEMMFloatCalculator.prototype.bindVertices = function() {\n\tvar gl = this.webgl.context,\n\t\trenderer = this.program;\n\n\t// bind vertices\n\tvar aPos = gl.getAttribLocation(renderer,\"aPos\");\n\tvar vertexBuffer = gl.createBuffer();\n\tgl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n\n\t// define a square that covers the screen\n\tvar vertices = [-1.0, -1.0, 0.0,\t// bottom left\n\t\t\t\t\t 1.0, -1.0, 0.0,\t// bottom right\n\t\t\t\t\t 1.0,  1.0, 0.0,\t// top right\n\t\t\t\t\t-1.0,  1.0, 0.0];\t// top left\n\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n\tgl.vertexAttribPointer(aPos, /*item size*/3, gl.FLOAT, false, 0, 0);\n\tgl.enableVertexAttribArray(aPos);\n\n\t// bind texture cords\n\tvar aTex = gl.getAttribLocation(renderer,\"aTex\");\n\tvar texCoords = gl.createBuffer();\n\tgl.bindBuffer(gl.ARRAY_BUFFER, texCoords);\n\tvar textureCoords = [0.0, 0.0,\n\t\t\t\t\t\t 1.0, 0.0,\n\t\t\t\t\t\t 1.0, 1.0,\n\t\t\t\t\t\t 0.0, 1.0];\n\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoords), gl.STATIC_DRAW);\n\tgl.vertexAttribPointer(aTex, /*item size*/2, gl.FLOAT, false, 0, 0);\n\tgl.enableVertexAttribArray(aTex);\n\n\t// index to vertices\n\tvar indices = gl.createBuffer();\n\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\t// tesselate square into triangles\n\t// indeces into vertex array creating triangles, with counter-clockwise winding\n\tvar vertexIndices = [0, 1, 2,\t// bottom right triangle\n\t\t\t\t\t\t 0, 2, 3];\t// top left triangle\n\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(vertexIndices), gl.STATIC_DRAW);\n};\n","/*!\n * async\n * https://github.com/caolan/async\n *\n * Copyright 2010-2014 Caolan McMahon\n * Released under the MIT license\n */\n(function () {\n\n    var async = {};\n    function noop() {}\n    function identity(v) {\n        return v;\n    }\n    function toBool(v) {\n        return !!v;\n    }\n    function notId(v) {\n        return !v;\n    }\n\n    // global on the server, window in the browser\n    var previous_async;\n\n    // Establish the root object, `window` (`self`) in the browser, `global`\n    // on the server, or `this` in some virtual machines. We use `self`\n    // instead of `window` for `WebWorker` support.\n    var root = typeof self === 'object' && self.self === self && self ||\n            typeof global === 'object' && global.global === global && global ||\n            this;\n\n    if (root != null) {\n        previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        return function() {\n            if (fn === null) throw new Error(\"Callback was already called.\");\n            fn.apply(this, arguments);\n            fn = null;\n        };\n    }\n\n    function _once(fn) {\n        return function() {\n            if (fn === null) return;\n            fn.apply(this, arguments);\n            fn = null;\n        };\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _toString = Object.prototype.toString;\n\n    var _isArray = Array.isArray || function (obj) {\n        return _toString.call(obj) === '[object Array]';\n    };\n\n    // Ported from underscore.js isObject\n    var _isObject = function(obj) {\n        var type = typeof obj;\n        return type === 'function' || type === 'object' && !!obj;\n    };\n\n    function _isArrayLike(arr) {\n        return _isArray(arr) || (\n            // has a positive integer length property\n            typeof arr.length === \"number\" &&\n            arr.length >= 0 &&\n            arr.length % 1 === 0\n        );\n    }\n\n    function _arrayEach(arr, iterator) {\n        var index = -1,\n            length = arr.length;\n\n        while (++index < length) {\n            iterator(arr[index], index, arr);\n        }\n    }\n\n    function _map(arr, iterator) {\n        var index = -1,\n            length = arr.length,\n            result = Array(length);\n\n        while (++index < length) {\n            result[index] = iterator(arr[index], index, arr);\n        }\n        return result;\n    }\n\n    function _range(count) {\n        return _map(Array(count), function (v, i) { return i; });\n    }\n\n    function _reduce(arr, iterator, memo) {\n        _arrayEach(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    }\n\n    function _forEachOf(object, iterator) {\n        _arrayEach(_keys(object), function (key) {\n            iterator(object[key], key);\n        });\n    }\n\n    function _indexOf(arr, item) {\n        for (var i = 0; i < arr.length; i++) {\n            if (arr[i] === item) return i;\n        }\n        return -1;\n    }\n\n    var _keys = Object.keys || function (obj) {\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    function _keyIterator(coll) {\n        var i = -1;\n        var len;\n        var keys;\n        if (_isArrayLike(coll)) {\n            len = coll.length;\n            return function next() {\n                i++;\n                return i < len ? i : null;\n            };\n        } else {\n            keys = _keys(coll);\n            len = keys.length;\n            return function next() {\n                i++;\n                return i < len ? keys[i] : null;\n            };\n        }\n    }\n\n    // Similar to ES6's rest param (http://ariya.ofilabs.com/2013/03/es6-and-rest-parameter.html)\n    // This accumulates the arguments passed into an array, after a given index.\n    // From underscore.js (https://github.com/jashkenas/underscore/pull/2140).\n    function _restParam(func, startIndex) {\n        startIndex = startIndex == null ? func.length - 1 : +startIndex;\n        return function() {\n            var length = Math.max(arguments.length - startIndex, 0);\n            var rest = Array(length);\n            for (var index = 0; index < length; index++) {\n                rest[index] = arguments[index + startIndex];\n            }\n            switch (startIndex) {\n                case 0: return func.call(this, rest);\n                case 1: return func.call(this, arguments[0], rest);\n            }\n            // Currently unused but handle cases outside of the switch statement:\n            // var args = Array(startIndex + 1);\n            // for (index = 0; index < startIndex; index++) {\n            //     args[index] = arguments[index];\n            // }\n            // args[startIndex] = rest;\n            // return func.apply(this, args);\n        };\n    }\n\n    function _withoutIndex(iterator) {\n        return function (value, index, callback) {\n            return iterator(value, callback);\n        };\n    }\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n\n    // capture the global reference to guard against fakeTimer mocks\n    var _setImmediate = typeof setImmediate === 'function' && setImmediate;\n\n    var _delay = _setImmediate ? function(fn) {\n        // not a direct alias for IE10 compatibility\n        _setImmediate(fn);\n    } : function(fn) {\n        setTimeout(fn, 0);\n    };\n\n    if (typeof process === 'object' && typeof process.nextTick === 'function') {\n        async.nextTick = process.nextTick;\n    } else {\n        async.nextTick = _delay;\n    }\n    async.setImmediate = _setImmediate ? _delay : async.nextTick;\n\n\n    async.forEach =\n    async.each = function (arr, iterator, callback) {\n        return async.eachOf(arr, _withoutIndex(iterator), callback);\n    };\n\n    async.forEachSeries =\n    async.eachSeries = function (arr, iterator, callback) {\n        return async.eachOfSeries(arr, _withoutIndex(iterator), callback);\n    };\n\n\n    async.forEachLimit =\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        return _eachOfLimit(limit)(arr, _withoutIndex(iterator), callback);\n    };\n\n    async.forEachOf =\n    async.eachOf = function (object, iterator, callback) {\n        callback = _once(callback || noop);\n        object = object || [];\n\n        var iter = _keyIterator(object);\n        var key, completed = 0;\n\n        while ((key = iter()) != null) {\n            completed += 1;\n            iterator(object[key], key, only_once(done));\n        }\n\n        if (completed === 0) callback(null);\n\n        function done(err) {\n            completed--;\n            if (err) {\n                callback(err);\n            }\n            // Check key is null in case iterator isn't exhausted\n            // and done resolved synchronously.\n            else if (key === null && completed <= 0) {\n                callback(null);\n            }\n        }\n    };\n\n    async.forEachOfSeries =\n    async.eachOfSeries = function (obj, iterator, callback) {\n        callback = _once(callback || noop);\n        obj = obj || [];\n        var nextKey = _keyIterator(obj);\n        var key = nextKey();\n        function iterate() {\n            var sync = true;\n            if (key === null) {\n                return callback(null);\n            }\n            iterator(obj[key], key, only_once(function (err) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    key = nextKey();\n                    if (key === null) {\n                        return callback(null);\n                    } else {\n                        if (sync) {\n                            async.setImmediate(iterate);\n                        } else {\n                            iterate();\n                        }\n                    }\n                }\n            }));\n            sync = false;\n        }\n        iterate();\n    };\n\n\n\n    async.forEachOfLimit =\n    async.eachOfLimit = function (obj, limit, iterator, callback) {\n        _eachOfLimit(limit)(obj, iterator, callback);\n    };\n\n    function _eachOfLimit(limit) {\n\n        return function (obj, iterator, callback) {\n            callback = _once(callback || noop);\n            obj = obj || [];\n            var nextKey = _keyIterator(obj);\n            if (limit <= 0) {\n                return callback(null);\n            }\n            var done = false;\n            var running = 0;\n            var errored = false;\n\n            (function replenish () {\n                if (done && running <= 0) {\n                    return callback(null);\n                }\n\n                while (running < limit && !errored) {\n                    var key = nextKey();\n                    if (key === null) {\n                        done = true;\n                        if (running <= 0) {\n                            callback(null);\n                        }\n                        return;\n                    }\n                    running += 1;\n                    iterator(obj[key], key, only_once(function (err) {\n                        running -= 1;\n                        if (err) {\n                            callback(err);\n                            errored = true;\n                        }\n                        else {\n                            replenish();\n                        }\n                    }));\n                }\n            })();\n        };\n    }\n\n\n    function doParallel(fn) {\n        return function (obj, iterator, callback) {\n            return fn(async.eachOf, obj, iterator, callback);\n        };\n    }\n    function doParallelLimit(fn) {\n        return function (obj, limit, iterator, callback) {\n            return fn(_eachOfLimit(limit), obj, iterator, callback);\n        };\n    }\n    function doSeries(fn) {\n        return function (obj, iterator, callback) {\n            return fn(async.eachOfSeries, obj, iterator, callback);\n        };\n    }\n\n    function _asyncMap(eachfn, arr, iterator, callback) {\n        callback = _once(callback || noop);\n        arr = arr || [];\n        var results = _isArrayLike(arr) ? [] : {};\n        eachfn(arr, function (value, index, callback) {\n            iterator(value, function (err, v) {\n                results[index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    }\n\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = doParallelLimit(_asyncMap);\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.inject =\n    async.foldl =\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachOfSeries(arr, function (x, i, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n\n    async.foldr =\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, identity).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n\n    async.transform = function (arr, memo, iterator, callback) {\n        if (arguments.length === 3) {\n            callback = iterator;\n            iterator = memo;\n            memo = _isArray(arr) ? [] : {};\n        }\n\n        async.eachOf(arr, function(v, k, cb) {\n            iterator(memo, v, k, cb);\n        }, function(err) {\n            callback(err, memo);\n        });\n    };\n\n    function _filter(eachfn, arr, iterator, callback) {\n        var results = [];\n        eachfn(arr, function (x, index, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    results.push({index: index, value: x});\n                }\n                callback();\n            });\n        }, function () {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    }\n\n    async.select =\n    async.filter = doParallel(_filter);\n\n    async.selectLimit =\n    async.filterLimit = doParallelLimit(_filter);\n\n    async.selectSeries =\n    async.filterSeries = doSeries(_filter);\n\n    function _reject(eachfn, arr, iterator, callback) {\n        _filter(eachfn, arr, function(value, cb) {\n            iterator(value, function(v) {\n                cb(!v);\n            });\n        }, callback);\n    }\n    async.reject = doParallel(_reject);\n    async.rejectLimit = doParallelLimit(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    function _createTester(eachfn, check, getResult) {\n        return function(arr, limit, iterator, cb) {\n            function done() {\n                if (cb) cb(getResult(false, void 0));\n            }\n            function iteratee(x, _, callback) {\n                if (!cb) return callback();\n                iterator(x, function (v) {\n                    if (cb && check(v)) {\n                        cb(getResult(true, x));\n                        cb = iterator = false;\n                    }\n                    callback();\n                });\n            }\n            if (arguments.length > 3) {\n                eachfn(arr, limit, iteratee, done);\n            } else {\n                cb = iterator;\n                iterator = limit;\n                eachfn(arr, iteratee, done);\n            }\n        };\n    }\n\n    async.any =\n    async.some = _createTester(async.eachOf, toBool, identity);\n\n    async.someLimit = _createTester(async.eachOfLimit, toBool, identity);\n\n    async.all =\n    async.every = _createTester(async.eachOf, notId, notId);\n\n    async.everyLimit = _createTester(async.eachOfLimit, notId, notId);\n\n    function _findGetResult(v, x) {\n        return x;\n    }\n    async.detect = _createTester(async.eachOf, identity, _findGetResult);\n    async.detectSeries = _createTester(async.eachOfSeries, identity, _findGetResult);\n    async.detectLimit = _createTester(async.eachOfLimit, identity, _findGetResult);\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                callback(null, _map(results.sort(comparator), function (x) {\n                    return x.value;\n                }));\n            }\n\n        });\n\n        function comparator(left, right) {\n            var a = left.criteria, b = right.criteria;\n            return a < b ? -1 : a > b ? 1 : 0;\n        }\n    };\n\n    async.auto = function (tasks, concurrency, callback) {\n        if (!callback) {\n            // concurrency is optional, shift the args.\n            callback = concurrency;\n            concurrency = null;\n        }\n        callback = _once(callback || noop);\n        var keys = _keys(tasks);\n        var remainingTasks = keys.length;\n        if (!remainingTasks) {\n            return callback(null);\n        }\n        if (!concurrency) {\n            concurrency = remainingTasks;\n        }\n\n        var results = {};\n        var runningTasks = 0;\n\n        var listeners = [];\n        function addListener(fn) {\n            listeners.unshift(fn);\n        }\n        function removeListener(fn) {\n            var idx = _indexOf(listeners, fn);\n            if (idx >= 0) listeners.splice(idx, 1);\n        }\n        function taskComplete() {\n            remainingTasks--;\n            _arrayEach(listeners.slice(0), function (fn) {\n                fn();\n            });\n        }\n\n        addListener(function () {\n            if (!remainingTasks) {\n                callback(null, results);\n            }\n        });\n\n        _arrayEach(keys, function (k) {\n            var task = _isArray(tasks[k]) ? tasks[k]: [tasks[k]];\n            var taskCallback = _restParam(function(err, args) {\n                runningTasks--;\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _forEachOf(results, function(val, rkey) {\n                        safeResults[rkey] = val;\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            });\n            var requires = task.slice(0, task.length - 1);\n            // prevent dead-locks\n            var len = requires.length;\n            var dep;\n            while (len--) {\n                if (!(dep = tasks[requires[len]])) {\n                    throw new Error('Has inexistant dependency');\n                }\n                if (_isArray(dep) && _indexOf(dep, k) >= 0) {\n                    throw new Error('Has cyclic dependencies');\n                }\n            }\n            function ready() {\n                return runningTasks < concurrency && _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            }\n            if (ready()) {\n                runningTasks++;\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                addListener(listener);\n            }\n            function listener() {\n                if (ready()) {\n                    runningTasks++;\n                    removeListener(listener);\n                    task[task.length - 1](taskCallback, results);\n                }\n            }\n        });\n    };\n\n\n\n    async.retry = function(times, task, callback) {\n        var DEFAULT_TIMES = 5;\n        var DEFAULT_INTERVAL = 0;\n\n        var attempts = [];\n\n        var opts = {\n            times: DEFAULT_TIMES,\n            interval: DEFAULT_INTERVAL\n        };\n\n        function parseTimes(acc, t){\n            if(typeof t === 'number'){\n                acc.times = parseInt(t, 10) || DEFAULT_TIMES;\n            } else if(typeof t === 'object'){\n                acc.times = parseInt(t.times, 10) || DEFAULT_TIMES;\n                acc.interval = parseInt(t.interval, 10) || DEFAULT_INTERVAL;\n            } else {\n                throw new Error('Unsupported argument type for \\'times\\': ' + typeof t);\n            }\n        }\n\n        var length = arguments.length;\n        if (length < 1 || length > 3) {\n            throw new Error('Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)');\n        } else if (length <= 2 && typeof times === 'function') {\n            callback = task;\n            task = times;\n        }\n        if (typeof times !== 'function') {\n            parseTimes(opts, times);\n        }\n        opts.callback = callback;\n        opts.task = task;\n\n        function wrappedTask(wrappedCallback, wrappedResults) {\n            function retryAttempt(task, finalAttempt) {\n                return function(seriesCallback) {\n                    task(function(err, result){\n                        seriesCallback(!err || finalAttempt, {err: err, result: result});\n                    }, wrappedResults);\n                };\n            }\n\n            function retryInterval(interval){\n                return function(seriesCallback){\n                    setTimeout(function(){\n                        seriesCallback(null);\n                    }, interval);\n                };\n            }\n\n            while (opts.times) {\n\n                var finalAttempt = !(opts.times-=1);\n                attempts.push(retryAttempt(opts.task, finalAttempt));\n                if(!finalAttempt && opts.interval > 0){\n                    attempts.push(retryInterval(opts.interval));\n                }\n            }\n\n            async.series(attempts, function(done, data){\n                data = data[data.length - 1];\n                (wrappedCallback || opts.callback)(data.err, data.result);\n            });\n        }\n\n        // If a callback is passed, run this as a controll flow\n        return opts.callback ? wrappedTask() : wrappedTask;\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = _once(callback || noop);\n        if (!_isArray(tasks)) {\n            var err = new Error('First argument to waterfall must be an array of functions');\n            return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        function wrapIterator(iterator) {\n            return _restParam(function (err, args) {\n                if (err) {\n                    callback.apply(null, [err].concat(args));\n                }\n                else {\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    ensureAsync(iterator).apply(null, args);\n                }\n            });\n        }\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    function _parallel(eachfn, tasks, callback) {\n        callback = callback || noop;\n        var results = _isArrayLike(tasks) ? [] : {};\n\n        eachfn(tasks, function (task, key, callback) {\n            task(_restParam(function (err, args) {\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                results[key] = args;\n                callback(err);\n            }));\n        }, function (err) {\n            callback(err, results);\n        });\n    }\n\n    async.parallel = function (tasks, callback) {\n        _parallel(async.eachOf, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel(_eachOfLimit(limit), tasks, callback);\n    };\n\n    async.series = function(tasks, callback) {\n        _parallel(async.eachOfSeries, tasks, callback);\n    };\n\n    async.iterator = function (tasks) {\n        function makeCallback(index) {\n            function fn() {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            }\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        }\n        return makeCallback(0);\n    };\n\n    async.apply = _restParam(function (fn, args) {\n        return _restParam(function (callArgs) {\n            return fn.apply(\n                null, args.concat(callArgs)\n            );\n        });\n    });\n\n    function _concat(eachfn, arr, fn, callback) {\n        var result = [];\n        eachfn(arr, function (x, index, cb) {\n            fn(x, function (err, y) {\n                result = result.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, result);\n        });\n    }\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        callback = callback || noop;\n        if (test()) {\n            var next = _restParam(function(err, args) {\n                if (err) {\n                    callback(err);\n                } else if (test.apply(this, args)) {\n                    iterator(next);\n                } else {\n                    callback(null);\n                }\n            });\n            iterator(next);\n        } else {\n            callback(null);\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        var calls = 0;\n        return async.whilst(function() {\n            return ++calls <= 1 || test.apply(this, arguments);\n        }, iterator, callback);\n    };\n\n    async.until = function (test, iterator, callback) {\n        return async.whilst(function() {\n            return !test.apply(this, arguments);\n        }, iterator, callback);\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        return async.doWhilst(iterator, function() {\n            return !test.apply(this, arguments);\n        }, callback);\n    };\n\n    async.during = function (test, iterator, callback) {\n        callback = callback || noop;\n\n        var next = _restParam(function(err, args) {\n            if (err) {\n                callback(err);\n            } else {\n                args.push(check);\n                test.apply(this, args);\n            }\n        });\n\n        var check = function(err, truth) {\n            if (err) {\n                callback(err);\n            } else if (truth) {\n                iterator(next);\n            } else {\n                callback(null);\n            }\n        };\n\n        test(check);\n    };\n\n    async.doDuring = function (iterator, test, callback) {\n        var calls = 0;\n        async.during(function(next) {\n            if (calls++ < 1) {\n                next(null, true);\n            } else {\n                test.apply(this, arguments);\n            }\n        }, iterator, callback);\n    };\n\n    function _queue(worker, concurrency, payload) {\n        if (concurrency == null) {\n            concurrency = 1;\n        }\n        else if(concurrency === 0) {\n            throw new Error('Concurrency must not be zero');\n        }\n        function _insert(q, data, pos, callback) {\n            if (callback != null && typeof callback !== \"function\") {\n                throw new Error(\"task callback must be a function\");\n            }\n            q.started = true;\n            if (!_isArray(data)) {\n                data = [data];\n            }\n            if(data.length === 0 && q.idle()) {\n                // call drain immediately if there are no tasks\n                return async.setImmediate(function() {\n                    q.drain();\n                });\n            }\n            _arrayEach(data, function(task) {\n                var item = {\n                    data: task,\n                    callback: callback || noop\n                };\n\n                if (pos) {\n                    q.tasks.unshift(item);\n                } else {\n                    q.tasks.push(item);\n                }\n\n                if (q.tasks.length === q.concurrency) {\n                    q.saturated();\n                }\n            });\n            async.setImmediate(q.process);\n        }\n        function _next(q, tasks) {\n            return function(){\n                workers -= 1;\n\n                var removed = false;\n                var args = arguments;\n                _arrayEach(tasks, function (task) {\n                    _arrayEach(workersList, function (worker, index) {\n                        if (worker === task && !removed) {\n                            workersList.splice(index, 1);\n                            removed = true;\n                        }\n                    });\n\n                    task.callback.apply(task, args);\n                });\n                if (q.tasks.length + workers === 0) {\n                    q.drain();\n                }\n                q.process();\n            };\n        }\n\n        var workers = 0;\n        var workersList = [];\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            payload: payload,\n            saturated: noop,\n            empty: noop,\n            drain: noop,\n            started: false,\n            paused: false,\n            push: function (data, callback) {\n                _insert(q, data, false, callback);\n            },\n            kill: function () {\n                q.drain = noop;\n                q.tasks = [];\n            },\n            unshift: function (data, callback) {\n                _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (!q.paused && workers < q.concurrency && q.tasks.length) {\n                    while(workers < q.concurrency && q.tasks.length){\n                        var tasks = q.payload ?\n                            q.tasks.splice(0, q.payload) :\n                            q.tasks.splice(0, q.tasks.length);\n\n                        var data = _map(tasks, function (task) {\n                            return task.data;\n                        });\n\n                        if (q.tasks.length === 0) {\n                            q.empty();\n                        }\n                        workers += 1;\n                        workersList.push(tasks[0]);\n                        var cb = only_once(_next(q, tasks));\n                        worker(data, cb);\n                    }\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            },\n            workersList: function () {\n                return workersList;\n            },\n            idle: function() {\n                return q.tasks.length + workers === 0;\n            },\n            pause: function () {\n                q.paused = true;\n            },\n            resume: function () {\n                if (q.paused === false) { return; }\n                q.paused = false;\n                var resumeCount = Math.min(q.concurrency, q.tasks.length);\n                // Need to call q.process once per concurrent\n                // worker to preserve full concurrency after pause\n                for (var w = 1; w <= resumeCount; w++) {\n                    async.setImmediate(q.process);\n                }\n            }\n        };\n        return q;\n    }\n\n    async.queue = function (worker, concurrency) {\n        var q = _queue(function (items, cb) {\n            worker(items[0], cb);\n        }, concurrency, 1);\n\n        return q;\n    };\n\n    async.priorityQueue = function (worker, concurrency) {\n\n        function _compareTasks(a, b){\n            return a.priority - b.priority;\n        }\n\n        function _binarySearch(sequence, item, compare) {\n            var beg = -1,\n                end = sequence.length - 1;\n            while (beg < end) {\n                var mid = beg + ((end - beg + 1) >>> 1);\n                if (compare(item, sequence[mid]) >= 0) {\n                    beg = mid;\n                } else {\n                    end = mid - 1;\n                }\n            }\n            return beg;\n        }\n\n        function _insert(q, data, priority, callback) {\n            if (callback != null && typeof callback !== \"function\") {\n                throw new Error(\"task callback must be a function\");\n            }\n            q.started = true;\n            if (!_isArray(data)) {\n                data = [data];\n            }\n            if(data.length === 0) {\n                // call drain immediately if there are no tasks\n                return async.setImmediate(function() {\n                    q.drain();\n                });\n            }\n            _arrayEach(data, function(task) {\n                var item = {\n                    data: task,\n                    priority: priority,\n                    callback: typeof callback === 'function' ? callback : noop\n                };\n\n                q.tasks.splice(_binarySearch(q.tasks, item, _compareTasks) + 1, 0, item);\n\n                if (q.tasks.length === q.concurrency) {\n                    q.saturated();\n                }\n                async.setImmediate(q.process);\n            });\n        }\n\n        // Start with a normal queue\n        var q = async.queue(worker, concurrency);\n\n        // Override push to accept second parameter representing priority\n        q.push = function (data, priority, callback) {\n            _insert(q, data, priority, callback);\n        };\n\n        // Remove unshift function\n        delete q.unshift;\n\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        return _queue(worker, 1, payload);\n    };\n\n    function _console_fn(name) {\n        return _restParam(function (fn, args) {\n            fn.apply(null, args.concat([_restParam(function (err, args) {\n                if (typeof console === 'object') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _arrayEach(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            })]));\n        });\n    }\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || identity;\n        var memoized = _restParam(function memoized(args) {\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                async.setImmediate(function () {\n                    callback.apply(null, memo[key]);\n                });\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([_restParam(function (args) {\n                    memo[key] = args;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                        q[i].apply(null, args);\n                    }\n                })]));\n            }\n        });\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n        return function () {\n            return (fn.unmemoized || fn).apply(null, arguments);\n        };\n    };\n\n    function _times(mapper) {\n        return function (count, iterator, callback) {\n            mapper(_range(count), iterator, callback);\n        };\n    }\n\n    async.times = _times(async.map);\n    async.timesSeries = _times(async.mapSeries);\n    async.timesLimit = function (count, limit, iterator, callback) {\n        return async.mapLimit(_range(count), limit, iterator, callback);\n    };\n\n    async.seq = function (/* functions... */) {\n        var fns = arguments;\n        return _restParam(function (args) {\n            var that = this;\n\n            var callback = args[args.length - 1];\n            if (typeof callback == 'function') {\n                args.pop();\n            } else {\n                callback = noop;\n            }\n\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([_restParam(function (err, nextargs) {\n                    cb(err, nextargs);\n                })]));\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        });\n    };\n\n    async.compose = function (/* functions... */) {\n        return async.seq.apply(null, Array.prototype.reverse.call(arguments));\n    };\n\n\n    function _applyEach(eachfn) {\n        return _restParam(function(fns, args) {\n            var go = _restParam(function(args) {\n                var that = this;\n                var callback = args.pop();\n                return eachfn(fns, function (fn, _, cb) {\n                    fn.apply(that, args.concat([cb]));\n                },\n                callback);\n            });\n            if (args.length) {\n                return go.apply(this, args);\n            }\n            else {\n                return go;\n            }\n        });\n    }\n\n    async.applyEach = _applyEach(async.eachOf);\n    async.applyEachSeries = _applyEach(async.eachOfSeries);\n\n\n    async.forever = function (fn, callback) {\n        var done = only_once(callback || noop);\n        var task = ensureAsync(fn);\n        function next(err) {\n            if (err) {\n                return done(err);\n            }\n            task(next);\n        }\n        next();\n    };\n\n    function ensureAsync(fn) {\n        return _restParam(function (args) {\n            var callback = args.pop();\n            args.push(function () {\n                var innerArgs = arguments;\n                if (sync) {\n                    async.setImmediate(function () {\n                        callback.apply(null, innerArgs);\n                    });\n                } else {\n                    callback.apply(null, innerArgs);\n                }\n            });\n            var sync = true;\n            fn.apply(this, args);\n            sync = false;\n        });\n    }\n\n    async.ensureAsync = ensureAsync;\n\n    async.constant = _restParam(function(values) {\n        var args = [null].concat(values);\n        return function (callback) {\n            return callback.apply(this, args);\n        };\n    });\n\n    async.wrapSync =\n    async.asyncify = function asyncify(func) {\n        return _restParam(function (args) {\n            var callback = args.pop();\n            var result;\n            try {\n                result = func.apply(this, args);\n            } catch (e) {\n                return callback(e);\n            }\n            // if result is Promise object\n            if (_isObject(result) && typeof result.then === \"function\") {\n                result.then(function(value) {\n                    callback(null, value);\n                })[\"catch\"](function(err) {\n                    callback(err.message ? err : new Error(err));\n                });\n            } else {\n                callback(null, result);\n            }\n        });\n    };\n\n    // Node.js\n    if (typeof module === 'object' && module.exports) {\n        module.exports = async;\n    }\n    // AMD / RequireJS\n    else if (typeof define === 'function' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","exports.load = function(url, callback) {\n\tvar xhr = new XMLHttpRequest();\n\n\txhr.onreadystatechange = function() {\n\t\tif (xhr.readyState !== 4) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (xhr.status >= 200 && xhr.status < 300) {\n\t\t\tcallback(null, xhr.responseText);\n\t\t} else {\n\t\t\tvar err = new Error(\"failed to request file '\" + url + \"'\");\n\t\t\t// follow Node.js error signature\n\t\t\terr.errno = 34;\n\t\t\tcallback(err);\n\t\t}\n\t};\n\n\ttry {\n\t\txhr.open('GET', url, true);\n\t\txhr.send(null);\n\t} catch (err) {\n\t\tcallback(err);\n\t}\n};","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n"]}